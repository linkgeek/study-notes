# PHP进程线程协程

**什么是进程？**

> **进程**：是一个“执行中的程序”，程序不执行就不会产生进程。一个执行中的程序至少会产生一个进程，当进程获得了处理机时才会从就绪状态变为运行状态，处理机不断切换地分配到每个进程中。决定同时有多少个进程处于运行状态的是处理器数量（CPU核数）

```
进程的三态模型：多个程序在系统中运行时，进程在处理机中交替运行，状态在不断切换。
三态分别是：就绪、运行、阻塞
```

![图片描述](https://segmentfault.com/img/bVWNcl?w=356&h=227)

```
进程的五态模型（在三态的基础上发展而来）：新建态、运行态、终止态、就绪态、等待态
```

------



**什么是线程？**

> **线程**：称之为`轻量级的进程`，程序执行流的最小单元。线程依赖于进程（一个进程可以有多个线程），线程不拥有系统资源。**`与同属一个进程的其他线程共享进程拥有的全部资源`**；`一个线程可以创建和撤销另一个线程，同一个进程中的多个线程可以并发执行`。一个进程下有多个线程来完成不同的工作称之为多线程。（一个进程下至少会有一个线程）

```
线程由来：由于用户并发请求，为每个请求都创建一个进程显然太浪费系统资源和影响响应用户请求的效率，线程的出现是为了降低上下文切换的消耗，提高系统的并发性，并突破一个进程只能干一样事的缺陷，使得进程内并发成为可能。
```

------



**什么是协程？**

> **协程**：协程是一种用户态的轻量级线程，又称微线程，英文名Coroutine，协程的调度完全由用户控制。人们通常将**协程和子程序**（函数）比较着理解。

```
//协程与线程的区别
1、协程是由用户自己调度，而线程是用系统调度
2、协程是异步的，而进程线程是同步的
3、一个线程可以有多个协程，一个进程也可以单独拥有多个协程
4、协程会保留上一次调用的状态
```



**进程与线程的区别**

每个进程都有一个进程控制块和用户地址空间，每个线程都有一个独立的栈和独立的控制块，都有自己一个独立执行上下文。
线程在执行过程中与进程有一些不同。每个独立的线程有一个程序运行的入口、顺序执行序列和程序的出口。 但是线程不能够独立执行，必须依存在于进程之中，由进程提供多个线程执行控制。 从逻辑角度来看，多线程的意义在于一个进程中，有多个执行部分可以同时执行。 此时，进程本身不是基本运行单位，而是线程的容器。

解析：

（1）进程是资源的分配和调度的一个独立单元，而线程是CPU调度的基本单元。
（2）同一个进程中可以包括多个线程，并且线程共享整个进程的资源（寄存器、堆栈、上下文）。一个线程只能属于一个进程，而一个进程可以有多个线程，一个进程至少包括一个线程。
 （3）进程的创建调用fork或者vfork，而线程的创建调用pthread_create，进程结束后它拥有的所有线程都将销毁，而线程的结束不会影响同个进程中的其他线程的结束。
 （4）线程是轻量级的进程，它的创建和销毁所需要的时间比进程小很多，CPU分给线程，即真正在CPU上运行的是线程。
 （5）线程中执行时一般都要进行同步和互斥，因为他们共享同一进程的所有资源。
 （6）线程有自己的私有属性TCB，线程id，寄存器、硬件上下文，而进程也有自己的私有属性进程控制块PCB，这些私有属性是不被共享的，用来标示一个进程或一个线程的标志。



**并发（Concurrency）**
是指能处理多个同时性活动的能力，并发事件之间不一定要同一时刻发生。

**并行（Parallesim）**
是指同时发生的两个并发事件，具有并发的含义，而并发则不一定并行。
多个操作可以在重叠的时间段内进行。

**并行和并发区别**
并发指的是程序的结构，并行指的是程序运行时的状态
并行一定是并发的，并行是并发设计的一种
单线程永远无法达到并行状态